openapi: 3.0.3
info:
  title: User Follow Service API
  version: 1.0.0
  description: |
    Microservice responsible for managing user follow relationships.
    User existence is validated via the Users service.

servers:
  - url: http://localhost:8080
    description: Local development

paths:
  /follow:
    post:
      summary: Follow a user
      description: Create a follow between two users.
      parameters:
        - name: user_id
          in: query
          required: true
          schema:
            type: integer
        - name: followed_id
          in: query
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: Successfully followed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
        "400":
          description: Invalid operation (e.g. self-follow)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: One or both users do not exist
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "409":
          description: Already following
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "503":
          description: Users service unavailable
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /unfollow:
    post:
      summary: Unfollow a user
      description: Remove a follow.
      parameters:
        - name: user_id
          in: query
          required: true
          schema:
            type: integer
        - name: followed_id
          in: query
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: Successfully unfollowed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessResponse"
        "404":
          description: One or both users do not exist
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "503":
          description: Users service unavailable
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /get-followers:
    get:
      summary: Get followers of a user
      description: Returns a list of user IDs who follow the given user.
      parameters:
        - name: user_id
          in: query
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: List of followers
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ListResponse"
        "404":
          description: User does not exist
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "503":
          description: Users service unavailable
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /get-following:
    get:
      summary: Get users followed by a user
      description: Returns a list of user IDs the user is following.
      parameters:
        - name: user_id
          in: query
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: List of followed users
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ListResponse"
        "404":
          description: User does not exist
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "503":
          description: Users service unavailable
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

components:
  schemas:
    SuccessResponse:
      type: object
      properties:
        status:
          type: string
          example: ok
        message:
          type: string
          example: success

    ErrorResponse:
      type: object
      properties:
        status:
          type: string
          example: error
        message:
          type: string
          example: user not found

    ListResponse:
      type: object
      properties:
        status:
          type: string
          example: ok
        data:
          type: array
          items:
            type: integer
          example: [1, 2, 3]
